<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>Klicka på Cirkeln!</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #f5f7fa, #c3cfe2);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      margin-top: 20px;
      font-size: 2rem;
      color: #333;
    }
    #score {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }
    #gameArea {
      position: relative;
      width: 80%;
      max-width: 800px;
      height: 500px;
      background-color: #ffffff;
      border: 2px solid #aaa;
      border-radius: 16px;
      overflow: hidden;
      margin-bottom: 20px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }
    #circle {
      position: absolute;
      width: 60px;
      height: 60px;
      background-color: #e63946;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    #shop {
      width: 80%;
      max-width: 800px;
      padding: 20px;
      background: #ffffffcc;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    .upgrade-btn {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      background-color: #457b9d;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .upgrade-btn:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    #prestigeMessage {
      margin-top: 10px;
      color: #2a9d8f;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>🔴 Klicka på Cirkeln!</h1>
  <div id="score">Poäng: 0</div>

  <div id="gameArea">
    <div id="circle" onclick="hitCircle()"></div>
  </div>

  <div id="shop">
    <h2>🛒 Uppgraderingar</h2>
    <button class="upgrade-btn" onclick="buyUpgrade('biggerCircle')" id="btnBigger">Större Cirkel (250 poäng)</button>
    <button class="upgrade-btn" onclick="buyUpgrade('morePoints')" id="btnMore">+1 Poäng/klick (100 poäng)</button>
    <button class="upgrade-btn" onclick="buyUpgrade('fastMove')" id="btnFast">Snabbare Rörelse (1 000 poäng)</button>
    <button class="upgrade-btn" onclick="buyUpgrade('megaClick')" id="btnMega">MegaKlick +10/klick (1 000 000 poäng)</button>
    <button class="upgrade-btn" onclick="buyUpgrade('superMultiplier')" id="btnSuper">2x Multiplikator (1 000 000 poäng)</button>
    <div id="prestigeMessage"></div>
  </div>

  <script>
    let score = 0;
    let basePoints = 1;
    let multiplier = 1;
    let prestige = 1;
    let circleSize = 60;
    let moveSpeed = 200;
    const circle = document.getElementById("circle");
    const gameArea = document.getElementById("gameArea");
    const scoreDisplay = document.getElementById("score");
    const prestigeMsg = document.getElementById("prestigeMessage");

    const trillion = 1_000_000_000_000;

    let upgrades = {
      biggerCircle: false,
      morePoints: 0,
      fastMove: false,
      megaClick: false,
      superMultiplier: false
    };

    function updateScoreDisplay() {
      scoreDisplay.innerText = `Poäng: ${score.toLocaleString()} (Prestige x${prestige})`;
      saveGame();
    }

    function moveCircle() {
      const maxX = gameArea.clientWidth - circleSize;
      const maxY = gameArea.clientHeight - circleSize;
      const x = Math.random() * maxX;
      const y = Math.random() * maxY;
      circle.style.left = x + "px";
      circle.style.top = y + "px";
    }

    function hitCircle() {
      let extra = upgrades.megaClick ? 10 : 0;
      const points = (basePoints + upgrades.morePoints + extra) * multiplier * prestige;
      score += points;
      updateScoreDisplay();
      checkPrestige();
      moveCircle();
    }

    function buyUpgrade(type) {
      if (type === "biggerCircle" && !upgrades.biggerCircle && score >= 250) {
        upgrades.biggerCircle = true;
        score -= 250;
        circleSize = 90;
        circle.style.width = circleSize + "px";
        circle.style.height = circleSize + "px";
        document.getElementById("btnBigger").disabled = true;
      } else if (type === "morePoints" && score >= 100) {
        upgrades.morePoints += 1;
        score -= 100;
      } else if (type === "fastMove" && !upgrades.fastMove && score >= 1000) {
        upgrades.fastMove = true;
        score -= 1000;
        moveSpeed = 100;
        circle.style.transition = `all ${moveSpeed}ms ease`;
        document.getElementById("btnFast").disabled = true;
      } else if (type === "megaClick" && !upgrades.megaClick && score >= 1_000_000) {
        upgrades.megaClick = true;
        score -= 1_000_000;
        document.getElementById("btnMega").disabled = true;
      } else if (type === "superMultiplier" && !upgrades.superMultiplier && score >= 1_000_000) {
        upgrades.superMultiplier = true;
        score -= 1_000_000;
        multiplier *= 2;
        document.getElementById("btnSuper").disabled = true;
      }
      updateScoreDisplay();
    }

    function checkPrestige() {
      if (score >= trillion) {
        prestige++;
        score = 0;
        basePoints = 1;
        multiplier = upgrades.superMultiplier ? 2 : 1;
        upgrades = {
          biggerCircle: false,
          morePoints: 0,
          fastMove: false,
          megaClick: false,
          superMultiplier: upgrades.superMultiplier // behåll multiplikator
        };
        circleSize = 60;
        moveSpeed = 200;
        circle.style.width = circleSize + "px";
        circle.style.height = circleSize + "px";
        circle.style.transition = `all ${moveSpeed}ms ease`;

        document.getElementById("btnBigger").disabled = false;
        document.getElementById("btnFast").disabled = false;
        document.getElementById("btnMega").disabled = upgrades.megaClick;
        document.getElementById("btnSuper").disabled = upgrades.superMultiplier;

        prestigeMsg.innerText = `🔁 Prestige aktiverad! Du är nu Prestige x${prestige}`;
        updateScoreDisplay();
      }
    }

    function saveGame() {
      const data = {
        score,
        prestige,
        upgrades,
        circleSize,
        moveSpeed,
        multiplier
      };
      localStorage.setItem("circleClickerSave", JSON.stringify(data));
    }

    function loadGame() {
      const save = localStorage.getItem("circleClickerSave");
      if (save) {
        const data = JSON.parse(save);
        score = data.score;
        prestige = data.prestige;
        upgrades = data.upgrades;
        circleSize = data.circleSize;
        moveSpeed = data.moveSpeed;
        multiplier = data.multiplier || 1;
        circle.style.width = circleSize + "px";
        circle.style.height = circleSize + "px";
        circle.style.transition = `all ${moveSpeed}ms ease`;

        if (upgrades.biggerCircle) document.getElementById("btnBigger").disabled = true;
        if (upgrades.fastMove) document.getElementById("btnFast").disabled = true;
        if (upgrades.megaClick) document.getElementById("btnMega").disabled = true;
        if (upgrades.superMultiplier) document.getElementById("btnSuper").disabled = true;
      }
    }

    // Init
    loadGame();
    updateScoreDisplay();
    moveCircle();
  </script>

</body>
</html>
